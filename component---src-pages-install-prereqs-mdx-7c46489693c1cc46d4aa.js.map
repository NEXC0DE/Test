{"version":3,"sources":["webpack:///./src/pages/install/prereqs.mdx"],"names":["_frontmatter","makeShortcode","name","props","console","warn","PageDescription","AnchorLinks","AnchorLink","InlineNotification","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","isMDXComponent"],"mappings":"yeAMO,IAAMA,EAAe,GAEtBC,EAAgB,SAAAC,GAAI,OAAI,SAA6BC,GAEzD,OADAC,QAAQC,KAAK,aAAeH,EAAO,2EAC5B,kBAASC,KAGZG,EAAkBL,EAAc,mBAChCM,EAAcN,EAAc,eAC5BO,EAAaP,EAAc,cAC3BQ,EAAqBR,EAAc,sBACnCS,EAAc,CAClBV,gBAEIW,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGX,E,oIACF,mBACD,OAAO,YAACQ,EAAD,KAAeD,EAAiBP,EAAhC,CAAuCW,WAAYA,EAAYC,QAAQ,cAG5E,YAACT,EAAD,CAAiBS,QAAQ,mBACvB,6JAEF,YAACR,EAAD,CAAaQ,QAAQ,eACvB,YAACP,EAAD,CAAYO,QAAQ,cAApB,yBACA,YAACP,EAAD,CAAYO,QAAQ,cAApB,yBACA,YAACP,EAAD,CAAYO,QAAQ,cAApB,6BACA,YAACP,EAAD,CAAYO,QAAQ,cAApB,+BACA,YAACP,EAAD,CAAYO,QAAQ,cAApB,wCACA,YAACP,EAAD,CAAYO,QAAQ,cAApB,qCAEE,+CACA,6CACA,mEACA,sBACE,kBAAIC,WAAW,MAAf,2CACA,kBAAIA,WAAW,MAAf,qBAEF,mDACA,8UAA6T,mBAAGA,WAAW,KAAQ,CAC/U,KAAQ,oDADiT,cAA7T,iEAGA,+CACA,kCACA,iDAAgC,0BAAYA,WAAW,KAAvB,cAAhC,sCACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,8GAUL,0EAAyD,mBAAGA,WAAW,KAAQ,CAC3E,KAAQ,mFAD6C,qCAAzD,KAGA,iCACA,sBACE,kBAAIA,WAAW,MAAf,OAA4B,sBAAQA,WAAW,MAAnB,WAA5B,yFACA,kBAAIA,WAAW,MAAf,qFACA,kBAAIA,WAAW,MAAf,8FAEF,kCAAiB,mBAAGA,WAAW,KAAQ,CACnC,KAAQ,kDADK,mDAGjB,mDACA,2HAA0G,0BAAYA,WAAW,KAAvB,eAA1G,gCAAkM,0BAAYA,WAAW,KAAvB,kBAAlM,QAAqQ,0BAAYA,WAAW,KAAvB,sBAArQ,KACA,2GACA,sBACE,kBAAIA,WAAW,MAAf,eAAoC,0BAAYA,WAAW,MAAvB,iCACpC,kBAAIA,WAAW,MAAf,cAAmC,0BAAYA,WAAW,MAAvB,iCAAnC,KAAmH,0BAAYA,WAAW,MAAvB,oCACnH,kBAAIA,WAAW,MAAf,UAA+B,0BAAYA,WAAW,MAAvB,UAA/B,KAAwF,0BAAYA,WAAW,MAAvB,UAAxF,KAAiJ,0BAAYA,WAAW,MAAvB,OAAjJ,KAAuM,0BAAYA,WAAW,MAAvB,QAAvM,KAA8P,0BAAYA,WAAW,MAAvB,SAA9P,KAAsT,0BAAYA,WAAW,MAAvB,UAAtT,KAA+W,0BAAYA,WAAW,MAAvB,WAEjX,mGACA,sBACE,kBAAIA,WAAW,MAAf,eAAoC,0BAAYA,WAAW,MAAvB,8BACpC,kBAAIA,WAAW,MAAf,cAAmC,0BAAYA,WAAW,MAAvB,gBAAnC,KAAkG,0BAAYA,WAAW,MAAvB,wBAClG,kBAAIA,WAAW,MAAf,UAA+B,0BAAYA,WAAW,MAAvB,OAA/B,KAAqF,0BAAYA,WAAW,MAAvB,UAEvF,8FACA,sBACE,kBAAIA,WAAW,MAAf,eAAoC,0BAAYA,WAAW,MAAvB,yBACpC,kBAAIA,WAAW,MAAf,cAAmC,0BAAYA,WAAW,MAAvB,8BACnC,kBAAIA,WAAW,MAAf,UAA+B,0BAAYA,WAAW,MAAvB,OAA/B,KAAqF,0BAAYA,WAAW,MAAvB,YAEvF,sHACA,sBACE,kBAAIA,WAAW,MAAf,sBACA,kBAAIA,WAAW,MAAf,cAAmC,0BAAYA,WAAW,MAAvB,eACnC,kBAAIA,WAAW,MAAf,UAA+B,0BAAYA,WAAW,MAAvB,OAA/B,KAAqF,0BAAYA,WAAW,MAAvB,UAEvF,sHACA,sBACE,kBAAIA,WAAW,MAAf,sBACA,kBAAIA,WAAW,MAAf,cAAmC,0BAAYA,WAAW,MAAvB,YAAnC,KAA8F,0BAAYA,WAAW,MAAvB,YAC9F,kBAAIA,WAAW,MAAf,UAA+B,0BAAYA,WAAW,MAAvB,UAA/B,KAAwF,0BAAYA,WAAW,MAAvB,UAAxF,KAAiJ,0BAAYA,WAAW,MAAvB,OAAjJ,KAAuM,0BAAYA,WAAW,MAAvB,QAAvM,KAA8P,0BAAYA,WAAW,MAAvB,SAA9P,KAAsT,0BAAYA,WAAW,MAAvB,UAAtT,KAA+W,0BAAYA,WAAW,MAAvB,WAEjX,sHACA,sBACE,kBAAIA,WAAW,MAAf,eAAoC,0BAAYA,WAAW,MAAvB,SACpC,kBAAIA,WAAW,MAAf,cAAmC,0BAAYA,WAAW,MAAvB,gBACnC,kBAAIA,WAAW,MAAf,UAA+B,0BAAYA,WAAW,MAAvB,UAA/B,KAAwF,0BAAYA,WAAW,MAAvB,UAAxF,KAAiJ,0BAAYA,WAAW,MAAvB,OAAjJ,KAAuM,0BAAYA,WAAW,MAAvB,QAAvM,KAA8P,0BAAYA,WAAW,MAAvB,SAA9P,KAAsT,0BAAYA,WAAW,MAAvB,UAAtT,KAA+W,0BAAYA,WAAW,MAAvB,WAEjX,oGACA,sBACE,kBAAIA,WAAW,MAAf,eAAoC,0BAAYA,WAAW,MAAvB,sBACpC,kBAAIA,WAAW,MAAf,cAAmC,0BAAYA,WAAW,MAAvB,MACnC,kBAAIA,WAAW,MAAf,UAA+B,0BAAYA,WAAW,MAAvB,UAA/B,KAAwF,0BAAYA,WAAW,MAAvB,UAAxF,KAAiJ,0BAAYA,WAAW,MAAvB,OAAjJ,KAAuM,0BAAYA,WAAW,MAAvB,QAAvM,KAA8P,0BAAYA,WAAW,MAAvB,SAA9P,KAAsT,0BAAYA,WAAW,MAAvB,UAAtT,KAA+W,0BAAYA,WAAW,MAAvB,WAEjX,4EACA,sBACE,kBAAIA,WAAW,MAAf,eAAoC,0BAAYA,WAAW,MAAvB,wBACpC,kBAAIA,WAAW,MAAf,cAAmC,0BAAYA,WAAW,MAAvB,oBACnC,kBAAIA,WAAW,MAAf,UAA+B,0BAAYA,WAAW,MAAvB,SAEjC,qDACA,2FAA0E,0BAAYA,WAAW,KAAvB,cAA1E,6GACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,sdA0BL,8DACA,2FAA0E,0BAAYA,WAAW,KAAvB,cAA1E,2HACA,YAACP,EAAD,CAAoBM,QAAQ,sBAC1B,qBAAG,sBAAQC,WAAW,KAAnB,SAAH,0DAEF,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,0rBAmCL,0DACA,+CAA8B,0BAAYA,WAAW,KAAvB,cAA9B,qHAA0M,mBAAGA,WAAW,KAAQ,CAC5N,KAAQ,sGAD8L,iBAA1M,yCAGA,6BAAY,0BAAYA,WAAW,KAAvB,kBAAZ,kGAAyK,0BAAYA,WAAW,KAAvB,gBAAzK,iGAKJH,EAAWI,gBAAiB","file":"component---src-pages-install-prereqs-mdx-7c46489693c1cc46d4aa.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/travis/build/IBM/datapower-operator-doc/node_modules/gatsby-theme-carbon/src/templates/Default.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst PageDescription = makeShortcode(\"PageDescription\");\nconst AnchorLinks = makeShortcode(\"AnchorLinks\");\nconst AnchorLink = makeShortcode(\"AnchorLink\");\nconst InlineNotification = makeShortcode(\"InlineNotification\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <PageDescription mdxType=\"PageDescription\">\n      <p>{`Ensure your environment meets the following requirements prior to installing the DataPower Operator and deploying Custom Resources.`}</p>\n    </PageDescription>\n    <AnchorLinks mdxType=\"AnchorLinks\">\n  <AnchorLink mdxType=\"AnchorLink\">Container environment</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Resource requirements</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Cluster-scope permissions</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Optional: PodSecurityPolicy</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Optional: SecurityContextConstraints</AnchorLink>\n  <AnchorLink mdxType=\"AnchorLink\">Optional: Multiple Failure Zones</AnchorLink>\n    </AnchorLinks>\n    <h2>{`Container environment`}</h2>\n    <h3>{`Supported platforms`}</h3>\n    <p>{`The DataPower Operator currently supports:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`OpenShift Container Platform (OCP) 4.6+`}</li>\n      <li parentName=\"ul\">{`Kubernetes 1.17+`}</li>\n    </ul>\n    <h3>{`Worker node configuration`}</h3>\n    <p>{`Installation of the DataPower Operator does not support adding Tolerations to the Operator Deployment resource out-of-the-box. To install properly, there must be one worker in the desired availability zone that is not tainted. If Tolerations are nonnegotiable, you can install the DataPower Operator using the `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/IBM/datapower-operator-chart\"\n      }}>{`helm chart`}</a>{` and add the Tolerations to the Deployment template manually.`}</p>\n    <h2>{`Resource requirements`}</h2>\n    <h3>{`Operator`}</h3>\n    <p>{`The DataPower Operator’s `}<inlineCode parentName=\"p\">{`Deployment`}</inlineCode>{` uses the following resource spec:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`resources:\n  requests:\n    cpu: \"500m\"\n    memory: \"512Mi\"\n  limits:\n    cpu: 2\n    memory: \"2Gi\"\n`}</code></pre>\n    <p>{`For more information on what this spec means, see `}<a parentName=\"p\" {...{\n        \"href\": \"https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/\"\n      }}>{`Managing Resources for Containers`}</a>{`.`}</p>\n    <h3>{`Operand`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`The `}<strong parentName=\"li\">{`minimum`}</strong>{` resource requirements for a single DataPower container are 4 CPU and 4 GB of memory.`}</li>\n      <li parentName=\"ul\">{`For API Connect workloads, a minimum of 8 GB of memory is required per container.`}</li>\n      <li parentName=\"ul\">{`For production high-availability, a minimum of 3 replicas (one per node) are recommended.`}</li>\n    </ul>\n    <p>{`See also: `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.ibm.com/support/pages/node/613133\"\n      }}>{`System requirements for IBM DataPower Gateways`}</a></p>\n    <h2>{`Cluster-scope permissions`}</h2>\n    <p>{`The DataPower Operator requires the following cluster-scope permissions. These are brought in by a `}<inlineCode parentName=\"p\">{`ClusterRole`}</inlineCode>{` and bound to the operator’s `}<inlineCode parentName=\"p\">{`ServiceAccount`}</inlineCode>{` via `}<inlineCode parentName=\"p\">{`ClusterRoleBinding`}</inlineCode>{`.`}</p>\n    <p>{`Permissions to manage CustomResourceDefinition defaulting and validating webhooks:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`API Groups: `}<inlineCode parentName=\"li\">{`admissionregistration.k8s.io`}</inlineCode></li>\n      <li parentName=\"ul\">{`Resources: `}<inlineCode parentName=\"li\">{`mutatingwebhookconfigurations`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`validatingwebhookconfigurations`}</inlineCode></li>\n      <li parentName=\"ul\">{`Verbs: `}<inlineCode parentName=\"li\">{`create`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`delete`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`get`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`list`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`patch`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`update`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`watch`}</inlineCode></li>\n    </ul>\n    <p>{`Permissions needed for reconciliation of admission controllers (webhooks):`}</p>\n    <ul>\n      <li parentName=\"ul\">{`API Groups: `}<inlineCode parentName=\"li\">{`rbac.authorization.k8s.io`}</inlineCode></li>\n      <li parentName=\"ul\">{`Resources: `}<inlineCode parentName=\"li\">{`clusterroles`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`clusterrolebindings`}</inlineCode></li>\n      <li parentName=\"ul\">{`Verbs: `}<inlineCode parentName=\"li\">{`get`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`list`}</inlineCode></li>\n    </ul>\n    <p>{`Permissions needed for management of owned CustomResourceDefinitions:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`API Groups: `}<inlineCode parentName=\"li\">{`apiextensions.k8s.io`}</inlineCode></li>\n      <li parentName=\"ul\">{`Resources: `}<inlineCode parentName=\"li\">{`customresourcedefinitions`}</inlineCode></li>\n      <li parentName=\"ul\">{`Verbs: `}<inlineCode parentName=\"li\">{`get`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`update`}</inlineCode></li>\n    </ul>\n    <p>{`Permissions needed for management of conversion webhook, which can exist in other namespaces:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`API Groups: (none)`}</li>\n      <li parentName=\"ul\">{`Resources: `}<inlineCode parentName=\"li\">{`namespaces`}</inlineCode></li>\n      <li parentName=\"ul\">{`Verbs: `}<inlineCode parentName=\"li\">{`get`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`list`}</inlineCode></li>\n    </ul>\n    <p>{`Permissions needed for management of conversion webhook, which can exist in other namespaces:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`API Groups: (none)`}</li>\n      <li parentName=\"ul\">{`Resources: `}<inlineCode parentName=\"li\">{`services`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`secrets`}</inlineCode></li>\n      <li parentName=\"ul\">{`Verbs: `}<inlineCode parentName=\"li\">{`create`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`delete`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`get`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`list`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`patch`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`update`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`watch`}</inlineCode></li>\n    </ul>\n    <p>{`Permissions needed for management of conversion webhook, which can exist in other namespaces:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`API Groups: `}<inlineCode parentName=\"li\">{`apps`}</inlineCode></li>\n      <li parentName=\"ul\">{`Resources: `}<inlineCode parentName=\"li\">{`deployments`}</inlineCode></li>\n      <li parentName=\"ul\">{`Verbs: `}<inlineCode parentName=\"li\">{`create`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`delete`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`get`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`list`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`patch`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`update`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`watch`}</inlineCode></li>\n    </ul>\n    <p>{`Permissions needed for conversion webhook implementation across namespaces:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`API Groups: `}<inlineCode parentName=\"li\">{`datapower.ibm.com`}</inlineCode></li>\n      <li parentName=\"ul\">{`Resources: `}<inlineCode parentName=\"li\">{`*`}</inlineCode></li>\n      <li parentName=\"ul\">{`Verbs: `}<inlineCode parentName=\"li\">{`create`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`delete`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`get`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`list`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`patch`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`update`}</inlineCode>{`, `}<inlineCode parentName=\"li\">{`watch`}</inlineCode></li>\n    </ul>\n    <p>{`Permissions needed for OCP platform related checks:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`API Groups: `}<inlineCode parentName=\"li\">{`config.openshift.io`}</inlineCode></li>\n      <li parentName=\"ul\">{`Resources: `}<inlineCode parentName=\"li\">{`clusterversions`}</inlineCode></li>\n      <li parentName=\"ul\">{`Verbs: `}<inlineCode parentName=\"li\">{`get`}</inlineCode></li>\n    </ul>\n    <h2>{`Optional: PodSecurityPolicy`}</h2>\n    <p>{`The DataPower Operator is expected to work as-is with the standard `}<inlineCode parentName=\"p\">{`restricted`}</inlineCode>{` PodSecurityPolicy; however, if you wish to leverage a more restrictive policy the following can be used.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`apiVersion: policy/v1beta1\nkind: PodSecurityPolicy\nmetadata:\n  name: ibm-datapower-operator-restricted-psp\nspec:\n  allowPrivilegeEscalation: false\n  forbiddenSysctls:\n    - '*'\n  hostNetwork: false\n  hostPorts: false\n  requiredDropCapabilities:\n    - ALL\n  runAsUser:\n    rule: MustRunAsNonRoot\n  seLinux:\n    rule: RunAsAny\n  volumes:\n    - configMap\n    - emptyDir\n    - projected\n    - secret\n    - downwardAPI\n    - persistentVolumeClaim\n`}</code></pre>\n    <h2>{`Optional: SecurityContextConstraints`}</h2>\n    <p>{`The DataPower Operator is expected to work as-is with the standard `}<inlineCode parentName=\"p\">{`restricted`}</inlineCode>{` SecurityContextConstraints; however, if you wish to leverage a more restrictive constraints the following can be used.`}</p>\n    <InlineNotification mdxType=\"InlineNotification\">\n      <p><strong parentName=\"p\">{`Note:`}</strong>{` This is only applicable to OpenShift (OCP) clusters.`}</p>\n    </InlineNotification>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`kind: SecurityContextConstraints\napiVersion: v1\nmetadata:\n  name: ibm-datapower-operator-scc\nallowHostDirVolumePlugin: false\nallowHostIPC: false\nallowHostNetwork: false\nallowHostPID: false\nallowHostPorts: false\nallowPrivilegeEscalation: false\nallowPrivilegedContainer: false\nallowedCapabilities: null\napiVersion: security.openshift.io/v1\ndefaultAddCapabilities: null\ngroups:\n  - system:authenticated\npriority: null\nreadOnlyRootFilesystem: false\nrequiredDropCapabilities:\n  - ALL\nrunAsUser:\n  type: MustRunAsNonRoot\nseLinuxContext:\n  type: RunAsAny\nusers: []\nvolumes:\n  - configMap\n  - downwardAPI\n  - emptyDir\n  - persistentVolumeClaim\n  - projected\n  - secret\n`}</code></pre>\n    <h2>{`Optional: Multiple Failure Zones`}</h2>\n    <p>{`The DataPower Operator `}<inlineCode parentName=\"p\">{`Deployment`}</inlineCode>{` is designed to pods evenly across multiple Kubernetes zones. To take advantage of this functionality, follow the `}<a parentName=\"p\" {...{\n        \"href\": \"https://kubernetes.io/docs/concepts/workloads/pods/pod-topology-spread-constraints/#prerequisites\"\n      }}>{`prerequisites`}</a>{` for Pod Topology Spread Constraints.`}</p>\n    <p>{`With `}<inlineCode parentName=\"p\">{`EvenPodsSpread`}</inlineCode>{` enabled in the cluster, no more than one DataPower Operator pod will be deployed per zone. If `}<inlineCode parentName=\"p\">{`replicaCount`}</inlineCode>{` is higher than the number of available zones, the remaining replicas will not be scheduled.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}