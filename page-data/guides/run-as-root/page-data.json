{"componentChunkName":"component---src-pages-guides-run-as-root-mdx","path":"/guides/run-as-root/","result":{"pageContext":{"frontmatter":{"title":"Running DataPower containers as root user","description":"Guide to deploying and running DataPower containers as root user"},"relativePagePath":"/guides/run-as-root.mdx","titleType":"page","MdxNode":{"id":"4f683a6f-a4c6-57d0-9036-0bf229eeea66","children":[],"parent":"b4815fd3-6e86-575b-a21b-8d94137451b2","internal":{"content":"---\ntitle: Running DataPower containers as root user\ndescription: Guide to deploying and running DataPower containers as root user\n---\n\n## Custom SecurityContextConstraint\n\nIf the DataPower Operator is installed on OpenShift Container Platform (OCP), then a custom `SecurityContextConstraint` must be created to allow the [`runAsRoot`](/apis/datapowerservice/v1beta3#runasroot) functionality of the DataPower operand.\n\nCopy the below YAML, and apply it to your OCP cluster as a prerequisite to enabling `runAsRoot` in the DataPowerService.\n\n### YAML\n\n```yaml\napiVersion: security.openshift.io/v1\nkind: SecurityContextConstraints\nmetadata:\n  annotations:\n    kubernetes.io/description: 'Custom SCC for running IBM DataPower Gateway pods as root user'\n  creationTimestamp: null\n  name: datapower-root\nallowHostDirVolumePlugin: false\nallowHostIPC: false\nallowHostNetwork: false\nallowHostPID: false\nallowHostPorts: false\nallowPrivilegeEscalation: true\nallowPrivilegedContainer: false\nallowedCapabilities:\n- '*'\ndefaultAddCapabilities: null\nfsGroup:\n  type: RunAsAny\ngroups: []\npriority: null\nreadOnlyRootFilesystem: false\nrequiredDropCapabilities: null\nrunAsUser:\n  type: RunAsAny\nseLinuxContext:\n  type: RunAsAny\nsupplementalGroups:\n  type: RunAsAny\nusers: []\nvolumes:\n- configMap\n- downwardAPI\n- emptyDir\n- persistentVolumeClaim\n- projected\n- secret\n```\n\n### Apply\n\n```\noc apply -f datapower-root.yaml\n```\n\n### Service Account\n\nThe DataPower Operator will automatically configure the default Service Account to bind to the above `datapower-root` SCC if [`runAsRoot`](/apis/datapowerservice/v1beta3#runasroot) is enabled in the DataPowerService. However, if you are using a custom ServiceAccount ([`serviceAccountName`](/apis/datapowerservice/v1beta3#serviceaccountname)), you must manually link this Service Account with the SCC.\n\n```\noc adm policy add-scc-to-user datapower-root -z <your-service-account>\n```\n","type":"Mdx","contentDigest":"fdc0f5ddae0c20c950bcb452072f8744","counter":125,"owner":"gatsby-plugin-mdx"},"frontmatter":{"title":"Running DataPower containers as root user","description":"Guide to deploying and running DataPower containers as root user"},"exports":{},"rawBody":"---\ntitle: Running DataPower containers as root user\ndescription: Guide to deploying and running DataPower containers as root user\n---\n\n## Custom SecurityContextConstraint\n\nIf the DataPower Operator is installed on OpenShift Container Platform (OCP), then a custom `SecurityContextConstraint` must be created to allow the [`runAsRoot`](/apis/datapowerservice/v1beta3#runasroot) functionality of the DataPower operand.\n\nCopy the below YAML, and apply it to your OCP cluster as a prerequisite to enabling `runAsRoot` in the DataPowerService.\n\n### YAML\n\n```yaml\napiVersion: security.openshift.io/v1\nkind: SecurityContextConstraints\nmetadata:\n  annotations:\n    kubernetes.io/description: 'Custom SCC for running IBM DataPower Gateway pods as root user'\n  creationTimestamp: null\n  name: datapower-root\nallowHostDirVolumePlugin: false\nallowHostIPC: false\nallowHostNetwork: false\nallowHostPID: false\nallowHostPorts: false\nallowPrivilegeEscalation: true\nallowPrivilegedContainer: false\nallowedCapabilities:\n- '*'\ndefaultAddCapabilities: null\nfsGroup:\n  type: RunAsAny\ngroups: []\npriority: null\nreadOnlyRootFilesystem: false\nrequiredDropCapabilities: null\nrunAsUser:\n  type: RunAsAny\nseLinuxContext:\n  type: RunAsAny\nsupplementalGroups:\n  type: RunAsAny\nusers: []\nvolumes:\n- configMap\n- downwardAPI\n- emptyDir\n- persistentVolumeClaim\n- projected\n- secret\n```\n\n### Apply\n\n```\noc apply -f datapower-root.yaml\n```\n\n### Service Account\n\nThe DataPower Operator will automatically configure the default Service Account to bind to the above `datapower-root` SCC if [`runAsRoot`](/apis/datapowerservice/v1beta3#runasroot) is enabled in the DataPowerService. However, if you are using a custom ServiceAccount ([`serviceAccountName`](/apis/datapowerservice/v1beta3#serviceaccountname)), you must manually link this Service Account with the SCC.\n\n```\noc adm policy add-scc-to-user datapower-root -z <your-service-account>\n```\n","fileAbsolutePath":"/home/travis/build/IBM/datapower-operator-doc/src/pages/guides/run-as-root.mdx"}}}}