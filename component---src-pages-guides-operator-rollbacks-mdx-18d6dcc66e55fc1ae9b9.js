(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{P6jx:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return i})),n.d(t,"default",(function(){return m}));n("91GP"),n("rGqo"),n("yt8O"),n("Btvt"),n("RW0V"),n("q1tI");var a=n("7ljp"),o=n("013z");n("qKvR");function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var i={},l=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(a.b)("div",t)}},p=l("PageDescription"),b=l("AnchorLinks"),c=l("AnchorLink"),s={_frontmatter:i},d=o.a;function m(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,["components"]);return Object(a.b)(d,r({},s,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)(p,{mdxType:"PageDescription"},Object(a.b)("p",null,"This page describes the process to rollback an operator installation to a previous version.")),Object(a.b)(b,{mdxType:"AnchorLinks"},Object(a.b)(c,{mdxType:"AnchorLink"},"Operand compatibility"),Object(a.b)(c,{mdxType:"AnchorLink"},"Rollback via OLM"),Object(a.b)(c,{mdxType:"AnchorLink"},"Rollback via Helm")),Object(a.b)("h2",null,"Operand compatibility"),Object(a.b)("p",null,"Prior to rolling back (downgrading) an operator installation, any DataPower operands (",Object(a.b)("inlineCode",{parentName:"p"},"DataPowerService")," custom resources) currently being managed by the operator must be made compatible with the desired (lower) version of the operator. One main consideration here should be the ",Object(a.b)("inlineCode",{parentName:"p"},"spec.version")," of the ",Object(a.b)("inlineCode",{parentName:"p"},"DataPowerService")," operand, as the supported values for this field gnerally may change between operator versions. As an example, operator version ",Object(a.b)("inlineCode",{parentName:"p"},"1.2.0")," adds support for ",Object(a.b)("inlineCode",{parentName:"p"},"spec.version: 10.0.1.1"),"."),Object(a.b)("p",null,"Thus, if an operator is running ",Object(a.b)("inlineCode",{parentName:"p"},"1.2.0")," and reconciles a DataPower operand with ",Object(a.b)("inlineCode",{parentName:"p"},"spec.version: 10.0.1.1"),", the operand must be downgraded to ",Object(a.b)("inlineCode",{parentName:"p"},"10.0.1.0")," prior to rolling the operator back to ",Object(a.b)("inlineCode",{parentName:"p"},"1.1.x")," (where ",Object(a.b)("inlineCode",{parentName:"p"},"10.0.1.0")," is the highest version ",Object(a.b)("inlineCode",{parentName:"p"},"1.1.x")," supports)."),Object(a.b)("p",null,"To modify the operand, edit any ",Object(a.b)("inlineCode",{parentName:"p"},"DataPowerService")," custom resources (CRs) and change the value of ",Object(a.b)("inlineCode",{parentName:"p"},"spec.version")," (and any other applicable configurations) such that the CR is compatible with the desired lower operator version."),Object(a.b)("h2",null,"Rollback via OLM"),Object(a.b)("p",null,"To rollback (downgrade) an operator installation that is managed by OLM, the operator must be ",Object(a.b)("strong",{parentName:"p"},"reinstalled")," as OLM does not support downgrading operators."),Object(a.b)("h3",null,"Example"),Object(a.b)("p",null,"Given:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"You have a DataPower Operator installed, with channel ",Object(a.b)("inlineCode",{parentName:"li"},"v1.2-eus")," selected with an ",Object(a.b)("inlineCode",{parentName:"li"},"Automatic")," subscription."),Object(a.b)("li",{parentName:"ul"},"You wish to rollback (downgrade) to ",Object(a.b)("inlineCode",{parentName:"li"},"v1.1")," with an ",Object(a.b)("inlineCode",{parentName:"li"},"Automatic")," subscription.")),Object(a.b)("p",null,"Flow:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},"Edit applicable ",Object(a.b)("inlineCode",{parentName:"li"},"DataPowerService")," CRs to ensure compatibility with ",Object(a.b)("inlineCode",{parentName:"li"},"v1.1")," operator."),Object(a.b)("li",{parentName:"ol"},"Delete the ",Object(a.b)("inlineCode",{parentName:"li"},"v1.2-eus")," subscription / installation, leaving any operands deployed in the namespace."),Object(a.b)("li",{parentName:"ol"},"Create a new ",Object(a.b)("inlineCode",{parentName:"li"},"v1.1")," subscription, triggering the new installation.")),Object(a.b)("h2",null,"Rollback via Helm"),Object(a.b)("p",null,"To rollback (downgrade) an operator installation that was deployed using our Helm chart, the ",Object(a.b)("inlineCode",{parentName:"p"},"helm rollback")," command can be used."),Object(a.b)("h3",null,"Example"),Object(a.b)("p",null,"Given:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},"You have a DataPower Operator installed, at version ",Object(a.b)("inlineCode",{parentName:"li"},"1.2.0"),", which was upgraded from ",Object(a.b)("inlineCode",{parentName:"li"},"1.1.1"),"."),Object(a.b)("li",{parentName:"ul"},"You wish to rollback (downgrade) to ",Object(a.b)("inlineCode",{parentName:"li"},"1.1.1"),".")),Object(a.b)("p",null,"Flow:"),Object(a.b)("ol",null,Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"Edit applicable ",Object(a.b)("inlineCode",{parentName:"p"},"DataPowerService")," CRs to ensure compatibility with ",Object(a.b)("inlineCode",{parentName:"p"},"1.1.1")," operator.")),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"Check revision history via ",Object(a.b)("inlineCode",{parentName:"p"},"helm history"),"."),Object(a.b)("pre",{parentName:"li"},Object(a.b)("code",r({parentName:"pre"},{}),"$ helm history datapower-operator\nREVISION        UPDATED                         STATUS          CHART                           APP VERSION     DESCRIPTION\n1               Mon Dec  7 14:23:56 2020        superseded      datapower-operator-1.1.1        1.1.1           Install complete\n2               Mon Dec  7 14:24:23 2020        deployed        datapower-operator-1.2.0        1.2.0           Upgrade complete\n"))),Object(a.b)("li",{parentName:"ol"},Object(a.b)("p",{parentName:"li"},"Perform the rollback, using appropriate ",Object(a.b)("inlineCode",{parentName:"p"},"REVISION")," number."),Object(a.b)("pre",{parentName:"li"},Object(a.b)("code",r({parentName:"pre"},{}),"$ helm rollback datapower-operator 1\nRollback was a success! Happy Helming!\n")))))}m.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-operator-rollbacks-mdx-18d6dcc66e55fc1ae9b9.js.map